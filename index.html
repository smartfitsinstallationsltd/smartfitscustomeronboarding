<!doctype html>
<html lang="en">
<head>
  <!-- =========================================================
    SMARTFITS CUSTOMER ONBOARDING
    Frontend: Cloudflare Pages
    Author: SmartFits
  ========================================================== -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>SmartFits | Customer Onboarding</title>
  <meta name="description" content="SmartFits Installations Ltd - Customer onboarding form, cancellation policy, services, and team contact details." />
  <meta name="theme-color" content="#030712" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Styles -->
  <link rel="stylesheet" href="/assets/styles.css" />

  <!-- Favicons (optional) -->
  <!-- <link rel="icon" href="/images/favicon.png" /> -->
</head>

<body>
  <!-- Background glow / effects -->
  <div class="bg-glow" aria-hidden="true"></div>

  <!-- =========================================================
    TOP BAR
  ========================================================== -->
  <header class="topbar">
    <div class="topbar__inner">

      <!-- Brand -->
      <div class="brand">
        <img class="brand__logo" src="/images/smartfits_logo.png" alt="SmartFits Logo" />
        <div class="brand__text">
          <div class="brand__name">SMARTFITS</div>
          <div class="brand__sub">Customer Onboarding</div>
        </div>
      </div>

      <!-- Actions -->
      <nav class="topbar__actions" aria-label="Top actions">
        <button id="openAdminBtn" class="btn btn--ghost" type="button">
          Sign in as an Admin
        </button>
      </nav>
    </div>
  </header>

  <!-- =========================================================
    MAIN
  ========================================================== -->
  <main class="container" id="pageRoot">

    <!-- =======================================================
      HERO
    ======================================================== -->
    <section class="hero card" id="heroSection">
      <div class="hero__left">
        <div class="kicker">WELCOME</div>
        <h1>SmartFits Installations Ltd</h1>
        <p class="muted">
          Thank you for choosing SmartFits Installations Ltd. Please complete the onboarding form below.
          This ensures your account is set up correctly and helps us support your fleet efficiently.
        </p>

        <div class="hero__meta">
          <div class="hero__metaItem">
            <span class="hero__metaLabel">Support</span>
            <span class="hero__metaValue">support@smartfits.co.uk</span>
          </div>
          <div class="hero__metaItem">
            <span class="hero__metaLabel">Website</span>
            <span class="hero__metaValue">smartfits.co.uk</span>
          </div>
        </div>
      </div>

      <div class="hero__right">
        <div class="hero__imageWrap">
          <img src="/images/introduction_image.png" alt="SmartFits header image" />
        </div>
      </div>
    </section>

    <!-- =======================================================
      CLIENT INFORMATION & FORM
    ======================================================== -->
    <section class="card section" id="formSection">
      <header class="section__head">
        <h2>Client Information &amp; Form</h2>
        <p class="muted">
          Please complete all required fields. We’ll use these details for invoicing and deployment setup.
        </p>
      </header>

      <form id="onboardingForm" class="form" autocomplete="on" novalidate>
        <!-- ----------------------------
          Company Details
        ----------------------------- -->
        <div class="section__subhead">
          <h3>Company Details</h3>
          <p class="muted small">
            Basic company information for our systems and invoicing.
          </p>
        </div>

        <div class="grid grid--2">
          <div class="field">
            <label for="fullCompanyName">Full Company Name <span class="req">*</span></label>
            <input id="fullCompanyName" name="fullCompanyName" type="text" required />
          </div>

          <div class="field">
            <label for="poNumber">Purchase Order Number (if required)</label>
            <input id="poNumber" name="poNumber" type="text" />
          </div>

          <div class="field">
            <label for="vatNumber">VAT Number <span class="req">*</span></label>
            <input id="vatNumber" name="vatNumber" type="text" required />
          </div>

          <div class="field">
            <label for="companyRegNumber">Company Registration Number <span class="req">*</span></label>
            <input id="companyRegNumber" name="companyRegNumber" type="text" required />
          </div>
        </div>

        <div class="field">
          <label for="invoiceAddress">Full Address for Invoicing Purposes <span class="req">*</span></label>
          <textarea id="invoiceAddress" name="invoiceAddress" rows="3" required></textarea>
        </div>

        <div class="divider"></div>

        <!-- ----------------------------
          Accounts Department
        ----------------------------- -->
        <div class="section__subhead">
          <h3>Accounts Department</h3>
          <p class="muted small">
            Where invoices and finance queries should be sent.
          </p>
        </div>

        <div class="grid grid--3">
          <div class="field">
            <label for="accountsContactName">Accounts Contact Name <span class="req">*</span></label>
            <input id="accountsContactName" name="accountsContactName" type="text" required />
          </div>

          <div class="field">
            <label for="accountsContactNumber">Accounts Contact Number <span class="req">*</span></label>
            <input id="accountsContactNumber" name="accountsContactNumber" type="tel" required />
          </div>

          <div class="field">
            <label for="accountsEmail">Accounts Email <span class="req">*</span></label>
            <input id="accountsEmail" name="accountsEmail" type="email" required />
          </div>
        </div>

        <div class="divider"></div>

        <!-- ----------------------------
          Installation Deployment
        ----------------------------- -->
        <div class="section__subhead">
          <h3>Installation Deployment</h3>
          <p class="muted small">
            The main contact we’ll liaise with for installation scheduling and project delivery.
          </p>
        </div>

        <div class="grid grid--3">
          <div class="field">
            <label for="mainContactName">Main Contact Name <span class="req">*</span></label>
            <input id="mainContactName" name="mainContactName" type="text" required />
          </div>

          <div class="field">
            <label for="mainContactNumber">Main Contact Number <span class="req">*</span></label>
            <input id="mainContactNumber" name="mainContactNumber" type="tel" required />
          </div>

          <div class="field">
            <label for="mainContactEmail">Main Contact Email <span class="req">*</span></label>
            <input id="mainContactEmail" name="mainContactEmail" type="email" required />
          </div>
        </div>

        <div class="divider"></div>

        <!-- ----------------------------
          Cancellation Policy Acceptance
        ----------------------------- -->
        <div class="section__subhead">
          <h3>Cancellation Policy</h3>
          <p class="muted small">
            Please confirm you have read and accepted the cancellation policy.
          </p>
        </div>

        <div class="field">
          <label>Cancellation Policy Agreement <span class="req">*</span></label>
          <div class="policyBox">
            <p>
              We understand schedules change. To keep our engineer network utilised efficiently,
              cancellation charges may apply if an appointment is cancelled too close to the scheduled time.
            </p>
            <p class="muted small">
              By selecting <strong>Yes</strong>, you confirm you have read and accepted the cancellation policy.
            </p>

            <div class="policyActions">
              <label class="radio">
                <input type="radio" name="acceptPolicyValue" value="Yes" required />
                <span>Yes, I accept</span>
              </label>

              <label class="radio">
                <input type="radio" name="acceptPolicyValue" value="No" required />
                <span>No</span>
              </label>
            </div>
          </div>
        </div>

        <!-- ----------------------------
          Submit
        ----------------------------- -->
        <div class="formActions">
          <button id="submitBtn" class="btn btn--primary" type="submit">
            Submit onboarding form
          </button>

          <div class="formStatus" id="formStatus" aria-live="polite"></div>
        </div>
      </form>
    </section>

    <!-- =======================================================
      CANCELLATION POLICY (FULL SECTION)
    ======================================================== -->
    <section class="card section" id="policySection">
      <header class="section__head">
        <h2>Cancellation Policy</h2>
        <p class="muted">A clear overview of our booking and cancellation terms.</p>
      </header>

      <div class="textBlock">
        <p>
          We aim to be flexible and minimise disruption to your operations. However, our engineers and booking team
          allocate time, travel, and resources around scheduled appointments.
        </p>

        <ul class="bulletList">
          <li>Please give as much notice as possible for cancellations or reschedules.</li>
          <li>Late cancellations may incur a charge to cover travel and engineer time.</li>
          <li>For large fleet deployments, schedules are agreed in advance to support efficient delivery.</li>
        </ul>

        <p class="muted small">
          If you have any questions about bookings, please contact our team via support@smartfits.co.uk.
        </p>
      </div>
    </section>

    <!-- =======================================================
      MORE SERVICES (RESTORED)
    ======================================================== -->
    <section class="card section" id="servicesSection">
      <header class="section__head">
        <h2>More Services</h2>
        <p class="muted">A snapshot of what SmartFits can support you with.</p>
      </header>

      <div class="serviceGrid" role="list">
        <article class="serviceCard" role="listitem">
          <h3>Telematics Installations</h3>
          <p>Nationwide fitting of aftermarket telematics devices for fleets of all sizes.</p>
        </article>

        <article class="serviceCard" role="listitem">
          <h3>Dashcams &amp; Camera Systems</h3>
          <p>Front/rear and multi-camera systems with professional fitting and configuration.</p>
        </article>

        <article class="serviceCard" role="listitem">
          <h3>Fleet Safety Upgrades</h3>
          <p>Driver safety solutions, sensors, tracking, and vehicle tech upgrades.</p>
        </article>

        <article class="serviceCard" role="listitem">
          <h3>Large Fleet Deployments</h3>
          <p>Project-led rollouts with reporting, scheduling support, and scalable delivery.</p>
        </article>
      </div>
    </section>

    <!-- =======================================================
      TEAM (RESTORED)
    ======================================================== -->
    <section class="card section" id="teamSection">
      <header class="section__head">
        <h2>SmartFits Installations Team</h2>
        <p class="muted">Click a team member to view contact details.</p>
      </header>

      <div class="teamGrid" id="teamGrid" aria-live="polite"></div>
    </section>

    <!-- =======================================================
      FOOTER NOTE
    ======================================================== -->
    <section class="footerNote">
      <p class="muted small">
        © <span id="yearNow"></span> SmartFits Installations Ltd. All rights reserved.
      </p>
    </section>

  </main>

  <!-- =========================================================
    PROFILE MODAL (TEAM MEMBER)
  ========================================================== -->
  <div class="modal" id="profileModal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="profileName">
    <div class="modal__panel">
      <div class="modal__head">
        <div class="modal__title" id="profileName">Profile</div>
        <button class="btn btn--ghost" id="closeProfileBtn" type="button">Close</button>
      </div>

      <div class="profileBody">
        <img id="profileImg" class="profileImg" src="" alt="" />
        <div class="profileInfo">
          <div class="profileRole" id="profileRole"></div>

          <div class="profileContactTitle">Contact Details</div>
          <div class="contactLine" id="profileEmail"></div>
          <div class="contactLine" id="profilePhone"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- =========================================================
    ADMIN DASHBOARD MODAL
    - Contains Sign-in UI + (hidden) Admin features UI
  ========================================================== -->
  <div class="modal" id="adminModal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="adminTitle">
    <div class="modal__panel modal__panel--wide">

      <!-- Header -->
      <div class="modal__head">
        <div class="modal__title" id="adminTitle">Admin Dashboard</div>
        <button class="btn btn--ghost" id="closeAdminBtn" type="button">Close</button>
      </div>

      <div class="adminWrap">

        <!-- ==========================
          SIGN-IN VIEW (shown when not signed in)
        =========================== -->
        <section id="adminSignedOutView" class="adminBlock">
          <h3>Admin Sign In</h3>
          <p class="muted small">Sign in to access the admin dashboard.</p>

          <form id="adminLoginForm" class="form" autocomplete="on" novalidate>
            <div class="grid grid--2">
              <div class="field">
                <label for="adminEmail">Email</label>
                <input id="adminEmail" name="email" type="email" placeholder="name@smartfits.co.uk" required />
              </div>

              <div class="field">
                <label for="adminPassword">Password</label>
                <input id="adminPassword" name="password" type="password" placeholder="Password" required />
              </div>
            </div>

            <div class="formActions">
              <div class="btnRow">
                <button class="btn btn--ghost" id="adminClearBtn" type="button">Clear</button>
                <button class="btn btn--primary" id="adminSignInBtn" type="submit">Sign in</button>
              </div>
              <div class="formStatus" id="adminLoginStatus" aria-live="polite"></div>
            </div>
          </form>
        </section>

        <!-- ==========================
          SIGNED-IN HEADER (shown when signed in)
        =========================== -->
        <section id="adminSignedInHeader" class="adminBlock" style="display:none;">
          <div class="adminSignedInBar">
            <div class="adminSignedInText" id="adminSignedInText">
              Signed in
            </div>
            <button class="btn btn--ghost" id="adminLogoutBtn" type="button">Log out</button>
          </div>
        </section>

        <!-- ==========================
          ADMIN FEATURES (hidden until signed in)
        =========================== -->
        <section id="adminFeatures" style="display:none;">

          <!-- ==========================================
            CUSTOMER ONBOARDING FORMS (SEARCH + VIEW + DELETE)
          =========================================== -->
          <section class="adminBlock">
            <h3>Customer Onboarding Forms</h3>
            <p class="muted small">
              Search saved onboarding PDFs and view or delete them.
            </p>

            <form id="fileSearchForm" class="form" novalidate>
              <div class="grid grid--2">
                <div class="field">
                  <label for="searchName">Search by file name</label>
                  <input id="searchName" name="q" type="text" placeholder="e.g. Tesco, RAC, 2026-01" />
                </div>

                <div class="field">
                  <label>&nbsp;</label>
                  <button id="toggleDateSearchBtn" type="button" class="btn btn--ghost">
                    Search by date too?
                  </button>
                </div>
              </div>

              <!-- Date filters (collapsed by default) -->
              <div id="dateSearchWrap" style="display:none;">
                <div class="grid grid--2">
                  <div class="field">
                    <label for="dateFrom">From</label>
                    <input id="dateFrom" name="from" type="date" />
                  </div>
                  <div class="field">
                    <label for="dateTo">To</label>
                    <input id="dateTo" name="to" type="date" />
                  </div>
                </div>
              </div>

              <div class="formActions">
                <button id="searchFilesBtn" type="submit" class="btn btn--primary">Search</button>
                <div class="formStatus" id="fileSearchStatus" aria-live="polite"></div>
              </div>
            </form>

            <!-- Results table -->
            <div class="tableWrap">
              <table class="table" aria-label="Onboarding form files">
                <thead>
                  <tr>
                    <th>File Name</th>
                    <th>Created</th>
                    <th style="width:220px;">Actions</th>
                  </tr>
                </thead>
                <tbody id="filesTbody">
                  <tr>
                    <td colspan="3" class="muted small">Sign in to view files.</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>

          <!-- ==========================================
            SEND WELCOME EMAIL (EML DOWNLOAD FLOW)
          =========================================== -->
          <section class="adminBlock">
            <h3>Send Welcome Email</h3>
            <p class="muted small">
              This generates a ready-to-send email file so it can be sent from your own mailbox (Outlook/Mail).
            </p>

            <form id="welcomeEmailForm" class="form" novalidate>
              <div class="grid grid--2">
                <div class="field">
                  <label for="welcomeCompany">Customer / Company Name <span class="req">*</span></label>
                  <input id="welcomeCompany" name="company" type="text" required />
                </div>

                <div class="field">
                  <label for="welcomeContact">Customer Contact Name (optional)</label>
                  <input id="welcomeContact" name="contact" type="text" />
                </div>
              </div>

              <div class="field">
                <label for="welcomeEmail">Customer Email Address <span class="req">*</span></label>
                <input id="welcomeEmail" name="to" type="email" required />
              </div>

              <div class="formActions">
                <button id="generateEmlBtn" type="submit" class="btn btn--primary">
                  Download email to send
                </button>
                <div class="formStatus" id="welcomeEmailStatus" aria-live="polite"></div>
              </div>

              <!-- Hidden anchor to trigger file download -->
              <a id="emlDownloadLink" href="#" download="SmartFits_Welcome_Email.eml" style="display:none;">Download</a>
            </form>
          </section>

          <!-- ==========================================
            ACTIVITY LOGS (Only show for users with permission)
          =========================================== -->
          <section class="adminBlock" id="logsBlock" style="display:none;">
            <h3>Activity Logs</h3>
            <p class="muted small">
              View system actions by admin users. Click a log row to see full details.
            </p>

            <form id="logsFilterForm" class="form" novalidate>
              <div class="grid grid--2">
                <div class="field">
                  <label for="logsFrom">From</label>
                  <input id="logsFrom" name="from" type="date" />
                </div>
                <div class="field">
                  <label for="logsTo">To</label>
                  <input id="logsTo" name="to" type="date" />
                </div>
              </div>

              <div class="grid grid--2">
                <div class="field">
                  <label for="logsAdminContains">Admin email contains</label>
                  <input id="logsAdminContains" name="adminContains" type="text" placeholder="e.g. tara@" />
                </div>

                <div class="field">
                  <label for="logsActionType">Action type</label>
                  <select id="logsActionType" name="actionType">
                    <option value="ALL">All</option>
                    <option value="LOGIN">Login</option>
                    <option value="SUBMIT_FORM">Submitted Form</option>
                    <option value="DELETE_FILE">Deleted File</option>
                    <option value="VIEW_FILE">Viewed File</option>
                    <option value="WELCOME_EMAIL">Generated Welcome Email</option>
                  </select>
                </div>
              </div>

              <div class="formActions">
                <button id="loadLogsBtn" type="submit" class="btn btn--primary">Load logs</button>
                <div class="formStatus" id="logsStatus" aria-live="polite"></div>
              </div>
            </form>

            <!-- Logs table -->
            <div class="tableWrap">
              <table class="table" aria-label="Activity logs">
                <thead>
                  <tr>
                    <th style="width:180px;">Time</th>
                    <th style="width:220px;">User</th>
                    <th style="width:200px;">Action</th>
                    <th>Summary</th>
                  </tr>
                </thead>
                <tbody id="logsTbody">
                  <tr>
                    <td colspan="4" class="muted small">No logs loaded.</td>
                  </tr>
                </tbody>
              </table>
            </div>

          </section>

        </section>
      </div>
    </div>
  </div>

  <!-- =========================================================
    LOG DETAILS MODAL (PLAIN ENGLISH DETAILS VIEW)
  ========================================================== -->
  <div class="modal" id="logDetailsModal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="logDetailsTitle">
    <div class="modal__panel">
      <div class="modal__head">
        <div class="modal__title" id="logDetailsTitle">Log Details</div>
        <button class="btn btn--ghost" id="closeLogDetailsBtn" type="button">Close</button>
      </div>

      <div class="logDetailsBody">
        <div class="logDetailsRow">
          <div class="logDetailsLabel">User</div>
          <div class="logDetailsValue" id="logDetailsUser">—</div>
        </div>

        <div class="logDetailsRow">
          <div class="logDetailsLabel">Action</div>
          <div class="logDetailsValue" id="logDetailsAction">—</div>
        </div>

        <div class="logDetailsRow">
          <div class="logDetailsLabel">Timestamp</div>
          <div class="logDetailsValue" id="logDetailsTime">—</div>
        </div>

        <div class="logDetailsRow">
          <div class="logDetailsLabel">Details</div>
          <pre class="logDetailsJson" id="logDetailsJson">{}</pre>
        </div>
      </div>
    </div>
  </div>

  <!-- =========================================================
    NOSCRIPT
  ========================================================== -->
  <noscript>
    <div style="padding:16px;max-width:900px;margin:20px auto;color:#fff;">
      This page requires JavaScript to function correctly.
    </div>
  </noscript>

  <!-- =========================================================
    SCRIPTS
  ========================================================== -->
  <script>
    // simple year stamp
    (function(){
      var el = document.getElementById("yearNow");
      if (el) el.textContent = String(new Date().getFullYear());
    })();
  </script>

  <!-- Your main JS -->
  <script src="/assets/app.js"></script>
</body>
</html>
